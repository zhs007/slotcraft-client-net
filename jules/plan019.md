# Plan 019: 提升测试覆盖率

## 1. 原始需求

经过最近几次重构（特别是操作队列的引入），项目的测试覆盖率从 90% 以上掉到了 83%。需要补充新的测试用例，将覆盖率重新提升到 90% 以上，以保证代码的健壮性和可维护性。

## 2. 目标

- 将 `src` 目录下的代码测试覆盖率提升至 90% 以上。
- 确保所有测试用例都能稳定通过。
- 确保代码符合项目的编码规范。

## 3. 任务分解

1.  **安装依赖**: 运行 `npm install` 确保开发环境正确。
2.  **评估现状**: 运行 `npm test` 生成当前的覆盖率报告，精确分析是哪些文件和代码分支导致了覆盖率下降。
3.  **补充测试**:
    - 根据覆盖率报告，编写新的单元测试或集成测试。
    - 重点关注近期修改较多的模块，如 `src/main.ts` 中的操作队列、`collect` 逻辑和错误处理部分。
4.  **验证结果**:
    - 反复运行 `npm test`，直到覆盖率达到 90% 以上。
    - 运行 `npm run check`，确保代码风格、类型检查和构建全部通过。
5.  **撰写报告**: 任务完成后，撰写 `jules/plan019-report.md`，记录整个过程。
6.  **更新文档**: 更新 `jules.md`，添加本次开发日志。
7.  **更新 Agent 指南**: 如有必要，更新 `agents.md`。
